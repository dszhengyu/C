DATAS SEGMENT
    DB '1975', '1976', '1977', '1978', '1979', '1980', '1981', '1982', '1983'
    DB '1984', '1985', '1986', '1987', '1988', '1989', '1990', '1991', '1992'
    DB '1993', '1994', '1995'
    
    DD 16, 22, 382, 1356, 2390, 8000, 16000, 24486, 50065, 97479, 140417, 197514
    DD 345980, 590827, 803530, 1183000, 1843000, 2759000, 3753000, 4649000, 5937000
    
    DW 3, 7, 9, 13, 28, 38, 130, 220, 476, 778, 1001, 1442, 2258, 2793, 4037
    DW 5635, 8226, 11542, 14430, 15257, 17800
DATAS ENDS

DATA SEGMENT
	DW 21 DUP (80 DUP (0))
DATA ENDS

TABLE SEGMENT
	DB 21 DUP ('YEAR SUMM NE ?? ')
TABLE ENDS

STACKS SEGMENT
    DW 32 DUP (0)
STACKS ENDS

CODES SEGMENT
    ASSUME CS:CODES,DS:DATAS,SS:STACKS
START:
    MOV AX,DATAS
    MOV DS,AX
    MOV AX, TABLE
	MOV ES, AX
    MOV AX, STACKS
    MOV SS, AX
    MOV SP, 64
    CALL ANALYSE
    
    MOV AX, DATA
    MOV DS, AX    
    CALL TABLEDATA
    
    MOV DH, 0
    MOV DL, 0
    MOV CX, 21
    MOV SI, 0
    MOV BX, 0
J:
	MOV SI, BX
	PUSH CX
	MOV CL, 2
    CALL SHOW_STR
    INC DH
    ADD BX, 160
    POP CX
    LOOP J
    
    MOV AH,4CH
    INT 21H
    
ANALYSE:
	PUSH AX
	PUSH BX
	PUSH CX
	PUSH DX
	PUSH DI
	PUSH SI
	MOV BX, 0
	MOV DI, 84
	MOV SI, DI
	ADD SI, 84
	MOV BP, 0	
	MOV CX, 21
S1:
	;MOVE YEAR
	MOV AX, [BX]
	MOV ES:[BP], AX
	ADD BX, 2
	ADD BP, 2
	MOV AX, [BX]
	MOV ES:[BP], AX
	ADD BX, 2
	PUSH BX
	ADD BP, 3
	;MOVE OTHERS
	MOV AX, DS:[DI]
	ADD DI, 2
	MOV DX, DS:[DI]
	ADD DI, 2
	MOV ES:[BP], AX
	ADD BP, 2
	MOV ES:[BP], DX
	ADD BP, 3
	MOV BX, DS:[SI]
	ADD SI, 2
	MOV ES:[BP], BX
	ADD BP, 3
	DIV BX
	MOV ES:[BP], AX
	ADD BP, 3
	POP BX
	LOOP S1
	POP SI
	POP DI
	POP DX
	POP CX
	POP BX
	POP AX
	RET	

TABLEDATA:
	MOV CX, 21
	MOV DI, 0
    MOV SI, 0
    MOV BP, 0
S2:
	MOV DI, BP
	;YEAR
	PUSH CX
	MOV AX, ES:[SI]
	MOV DS:[DI], AX
	ADD SI, 2
	ADD DI, 2
	MOV AX, ES:[SI]
	MOV DS:[DI], AX
	ADD SI, 2
	ADD DI, 2
	MOV AL, ES:[SI]
	MOV AH, AL
	MOV DS:[DI], AX
	ADD DI, 2
	MOV DS:[DI], AX
	ADD DI, 2
	MOV DS:[DI], AX
	ADD DI, 2
	INC SI
	;SUMM
	MOV AX, ES:[SI]
	ADD SI, 2
	MOV DX, ES:[SI]
	ADD SI, 3
	MOV BX, 0
DTOC1:
	MOV CX, 0AH
	CALL DIVDW
	ADD CX, 30H
	PUSH CX
	MOV CX, AX
	OR CX, DX
	INC BX
	JCXZ K1
	JMP DTOC1
K1:
	MOV AX, 010H
	SUB AX, BX
	MOV CX, BX
S3:
	POP DX
	MOV DS:[DI], DL
	INC DI
	LOOP S3
	MOV CX, AX
	MOV AX, 0020H
S4:
	MOV DS:[DI], AL
	INC DI
	LOOP S4
	;NE
	MOV AX, ES:[SI]
	MOV BX, 0
	MOV DX, 0
	ADD SI, 3
DTOC2:
	MOV CX, 0AH
	CALL DIVDW
	ADD CX, 30H
	PUSH CX
	MOV CX, AX
	OR CX, DX
	INC BX
	JCXZ K2
	JMP DTOC2
K2:
	MOV AX, 010H
	SUB AX, BX
	MOV CX, BX
S5:
	POP DX
	MOV DS:[DI], DL
	INC DI
	LOOP S5
	MOV CX, AX
	MOV AX, 0020H
S6:
	MOV DS:[DI], AL
	INC DI
	LOOP S6
	;??
	MOV AX, ES:[SI]
	MOV BX, 0
	MOV DX, 0
	ADD SI, 3	
DTOC3:
	MOV CX, 0AH
	CALL DIVDW
	ADD CX, 30H
	PUSH CX
	MOV CX, AX
	OR CX, DX
	INC BX
	JCXZ K3
	JMP DTOC3
K3:
	MOV AX, 010H
	SUB AX, BX
	MOV CX, BX
S7:
	POP DX
	MOV DS:[DI], DL
	INC DI
	LOOP S7
	MOV CX, AX
	MOV AX, 0020H
S8:
	MOV DS:[DI], AL
	INC DI
	LOOP S8
	
	;BIG LOOP
	ADD BP, 160
	POP CX
	SUB CX, 1
	JCXZ S9
	JMP S2
S9:
	RET


DIVDW:
	PUSH BX
	MOV BX, AX
	MOV AX, DX
	MOV DX, 0
	DIV CX
	PUSH AX
	MOV AX, BX
	DIV CX
	MOV CX, DX
	POP DX
	POP BX	
	RET
	
SHOW_STR:
	PUSH AX
	PUSH BX
	PUSH CX
	MOV BL, CL
	MOV AX, 0B800H
	MOV ES, AX
	MOV AX, 160
	MUL DH
	MOV DI, AX
	MOV AX, 2
	MUL DL
	ADD DI, AX
S:
	MOV CL, DS:[SI]
	JCXZ OK2
	MOV ES:[DI], CL
	INC DI
	MOV ES:[DI], BL
	INC DI
	INC SI
	JMP S
OK2:
	POP CX
	POP BX
	POP AX
	RET
	
CODES ENDS
    END START
